{"version":3,"file":"vamtiger.js","sources":["../source/types.ts","../source/config.ts","../source/bash/index.ts","../source/install.ts","../source/project-php-laravel.ts","../source/project.ts","../source/command-project.ts","../source/command-help.ts","../source/vamtiger.ts"],"sourcesContent":["export enum Command {\n    help = 'help',\n    project = 'project'\n}\n\nexport enum CommandDescription {\n    help = 'list commands',\n    project = 'create a new project'\n}\n\nexport enum Project {\n    phpLaravel = 'php-laravel'\n}\n\nexport enum ProjectDescription {\n    phpLaravel = 'PHP Laravel'\n}\n\nexport enum ProjectExample {\n    phpLaravel = 'vamtiger project --type php-laravel php-laravel-project'\n}\n\nexport enum Result {\n    createdProject = 'Created Project',\n    ignored = 'Ignored'\n}\n\nexport enum Prefix {\n    vamtigerProject = 'vamtiger-project',\n    doubleDash = '--'\n}\n\nexport enum StringConstant {\n    dash = '-',\n    newline = '\\n'\n}\n\nexport enum ProjectOptions {\n    type = 'type'\n}\n\nexport enum ProjectOptionsDescription {\n    type = 'Project type'\n}\n\nexport enum HiddenProjectOptions {\n    cliInstallOptional = 'cliInstallOptional'\n}\n\nexport enum Interface {\n    'api' = 'API',\n    'cli' = 'CLI'\n}\n\nexport enum PhpLaravelPath {\n    testsFeauture = 'tests/Feature',\n    behatYml = 'behat.yml'\n}\n\nexport enum CommandlineHelpTitle {\n    vamtiger = 'VAMTIGER - Web Development Utility\\nhttps://www.npmjs.com/package/vamtiger',\n    help = 'Commands:',\n    project = 'Project Options:',\n    projectType = 'Project Types:'\n}\n\nexport interface IStringObject {\n    [key: string]: string;\n}\n\nexport interface IProject {\n    type: Project;\n    name: string;\n    project?: string;\n    destination?: string;\n    cli?: boolean;\n    cliInstallOptional?: boolean;\n}\n\nexport interface IProjectPhpLaravel {\n    name: string;\n    source: string;\n    destination: string;\n}\n\nexport interface IInstall {\n    projects: string[];\n    cliInstallOptional?: boolean;\n}\n\nexport interface IInstalledProject {\n    path: string;\n}\n\nexport function ignore(params: any) {\n    return Result.ignored;\n}\n\nexport const errorMessage = {\n    noProjectTypeOptionSpecified: `No --${ProjectOptions.type} option specified (e.g. ${Prefix.vamtigerProject} ${Command.project} --${ProjectOptions.type} ${Project.phpLaravel} projec-name)`,\n    noProjectNameOptionSpecified: `No Project Name specified (e.g. ${Prefix.vamtigerProject} ${Command.project} --${ProjectOptions.type} ${Project.phpLaravel} projec-name)`\n};","import { resolve as resolvePath } from 'path';\n\nexport const projectFolder = resolvePath(\n    __dirname,\n    '..'\n);\n\nexport const npmApiInstallOptional = {\n    'save-optional': true,\n    'no-audit': true,\n    'prefix': projectFolder\n};","export default {\"npm-install-save-optional.sh\":\"npm install --save-optional\",\"php-laravel-create-project.sh\":\"composer create-project laravel/laravel .\",\"php-laravel-install-dev-dependencies.sh\":\"composer require --dev behat/behat\",\"php-laravel-install-dependencies.sh\":\"composer install\",\"php-laravel-is-composer-installed.sh\":\"command -v composer\"};","import * as npm from 'npm';\nimport bash from 'vamtiger-bash';\nimport {\n    IInstall\n} from './types';\nimport {\n    npmApiInstallOptional,\n    projectFolder\n} from './config';\nimport bashScript from './bash';\n\nexport default function (params: IInstall) {\n    const {\n        cliInstallOptional: cliOptional } = params;\n    const currentInstall = cliOptional ? cliInstallOptional\n        : apiInstall;\n\n    return currentInstall(params);\n}\n\nasync function cliInstallOptional(params: IInstall) {\n    const { projects } = params;\n    const currentProjects = projects.join(' ');\n    const command = `${bashScript['npm-install-save-optional.sh'].trim()} --prefix ${projectFolder} ${currentProjects}`;\n    const result = await bash(command);\n\n    return result.toString();\n}\n\nfunction apiInstall(params: IInstall) {return new Promise((resolve, reject) => {\n    const { projects } = params;\n\n    npm.load(npmApiInstallOptional, (error, loadData) => {\n        if (error) {\n            reject(error);\n        } else {\n            npm.commands.install(projects, (error, installData) => {\n                if (error) {\n                    reject(error);\n                } else {\n                    resolve({\n                        loadData,\n                        installData\n                    });\n                }\n            });\n        }\n    });\n})}","import { resolve as resolvePath } from 'path';\nimport {copy} from 'vamtiger-copy';\nimport copyFile from 'vamtiger-copy-file';\nimport bash from 'vamtiger-bash';\nimport getFolderContent from 'vamtiger-get-directory-content';\nimport createFolder from 'vamtiger-create-directory';\nimport remove from 'vamtiger-remove';\nimport {\n    IProject,\n    IInstalledProject,\n    IProjectPhpLaravel,\n    PhpLaravelPath } from './types';\nimport bashScript from './bash';\n\nexport default async function (params: IProject) {\n    const {\n        project,\n        name: projectFolder = '',\n        destination = process.cwd(),\n        cli = false\n    } = params;\n    const { path: source }: IInstalledProject = project && require(project)\n        || { path: '' };\n    const folderContent = await getFolderContent(destination);\n    const currentDestination = projectFolder &&\n        resolvePath(\n            destination,\n            projectFolder\n        )\n        ||\n        destination;\n    const composerIsInstalled = await bash(bashScript['php-laravel-is-composer-installed.sh'])\n        .then(output => Boolean(output.toString().trim()));\n    const copyParams = {\n        source,\n        destination: currentDestination\n    }\n\n    if (!folderContent.includes(projectFolder)) {\n        await createFolder(currentDestination);\n    }\n\n    if (composerIsInstalled) {\n        await createProjectWithComposer({\n            name: projectFolder,\n            source,\n            destination: currentDestination\n        });\n    } else {\n        await copy(copyParams);\n    }\n}\n\nasync function createProjectWithComposer(params: IProjectPhpLaravel) {\n    const {\n        source,\n        destination: cwd\n        } = params;\n    const sourceTestsFeaturesFolder = resolvePath(\n        source,\n        PhpLaravelPath.testsFeauture\n    );\n    const sourceBehatYml = resolvePath(\n        source,\n        PhpLaravelPath.behatYml\n    );\n    const destinationBehatYml = resolvePath(\n        cwd,\n        PhpLaravelPath.behatYml\n    );\n    const destinationTestFeaturesFolder = resolvePath(\n        cwd,\n        PhpLaravelPath.testsFeauture\n    );\n    const bashOptions = {\n        cwd\n    };\n    const creatProject = await Promise.all([\n        bash(\n            bashScript['php-laravel-create-project.sh'],\n            bashOptions\n        ).catch(error => error)\n    ]);\n    const installDevDependencies = await bash(\n        bashScript['php-laravel-install-dev-dependencies.sh'],\n        bashOptions\n    ).catch(error => error);\n    const removeTests = await remove({\n        folder: destinationTestFeaturesFolder\n    }).catch((error: any) => error);\n    const copyTests = await copy({\n        source: sourceTestsFeaturesFolder,\n        destination: destinationTestFeaturesFolder\n    }).catch((error: any) => error);\n    const copyBehatYml = await copyFile({\n        source: sourceBehatYml,\n        destination: destinationBehatYml\n    });\n    const result = {\n        creatProject: creatProject.toString(),\n        installDevDependencies: installDevDependencies.toString(),\n        removeTests,\n        copyTests,\n        copyBehatYml\n    };\n\n    return result;\n}","import {\n    IProject,\n    Project,\n    CommandlineHelpTitle,\n    Prefix,\n    StringConstant,\n    Result,\n    ignore\n} from './types';\nimport install from './install';\nimport phpLaravel from './project-php-laravel'\n\nconst createProject = {\n    [Project.phpLaravel]: phpLaravel\n}\n\nexport default async function (params: IProject) {\n    const { cliInstallOptional = false , cli = false } = params;\n    const cliMessage = cli && [\n        '',\n        CommandlineHelpTitle.vamtiger,\n        '',\n        Result.createdProject,\n        ''\n    ].join(StringConstant.newline);\n    const createCurrentProject = createProject[params.type] || ignore;\n    const project = [\n        Prefix.vamtigerProject,\n        params.type\n    ].join(StringConstant.dash);\n    const installParams = createCurrentProject && {\n        projects: [project],\n        cliInstallOptional: cliInstallOptional || cli\n    };\n\n    if (installParams) {\n        await install(installParams);\n    }\n\n    await createCurrentProject({...params, project});\n\n    if (cliMessage) {\n        console.log(cliMessage);\n    }\n\n    return Result.createdProject;\n}","import Args from 'vamtiger-argv/build/main';\nimport {\n    ProjectOptions,\n    Project,\n    errorMessage\n} from './types';\nimport project from './project';\n\nconst args = new Args();\n\nexport default function () {\n    const type = args.get(ProjectOptions.type) as Project\n        || '';\n    const name = args.raw[args.raw.length - 1];\n    const projectParams = type && name && {\n        type,\n        name,\n        cli: true\n    };\n\n    if (!type) {\n        throw new Error(errorMessage.noProjectTypeOptionSpecified);\n    } else if (!name) {\n        throw new Error(errorMessage.noProjectNameOptionSpecified);\n    } else if (projectParams) {\n        return project(projectParams);\n    }\n}","import commandLineHelp from 'vamtiger-commandline-help';\nimport Args from 'vamtiger-argv/build/main';\nimport {\n    Project,\n    ProjectDescription,\n    ProjectExample,\n    Command,\n    StringConstant,\n    CommandDescription,\n    CommandlineHelpTitle,\n    Prefix,\n    ProjectOptions,\n    ProjectOptionsDescription,\n    ignore\n    } from './types';\n\nconst args = new Args();\nconst getHelp = {\n    [Command.help]: help,\n    [Command.project]: projectHelp\n}\n\nexport default function () {\n    const { 3: commandArg } = args.raw;\n    const command = Command[(commandArg|| Command.help) as Command];\n    const getHelpText = getHelp[command] || ignore;\n    const helpText = [\n        CommandlineHelpTitle.vamtiger,\n        '',\n        getHelpText()\n    ].join(StringConstant.newline);\n\n    console.log(helpText);\n\n    return helpText;\n}\n\nfunction help() {\n    const helpText = [\n        CommandlineHelpTitle.help,\n        commandLineHelp({\n            command: Command,\n            description: CommandDescription\n        })\n    ].join(StringConstant.newline);\n\n    return helpText;\n}\n\nfunction projectHelp() {\n    const helpText = [\n        CommandlineHelpTitle.project,\n        commandLineHelp(\n            {\n                option: ProjectOptions,\n                description: ProjectOptionsDescription\n            },\n            {\n                options: ['option']\n            }\n        ),\n        '',\n        CommandlineHelpTitle.projectType,\n        commandLineHelp({\n            projectType: Project,\n            description: ProjectDescription,\n            example: ProjectExample\n        })\n    ].join(StringConstant.newline);\n\n    return helpText;\n}","import Args from 'vamtiger-argv/build/main';\nimport {\n    Command,\n    CommandDescription,\n    ProjectOptions,\n    Project,\n    ignore,\n    errorMessage\n} from './types';\nimport project from './command-project';\nimport help from './command-help';\n\nconst args = new Args();\nconst { 2: commandArg } = args.raw;\nconst currentCommand = Command[commandArg as Command];\nconst commands = {\n    [Command.help]: help,\n    [Command.project]: project\n}\nconst command = commands[currentCommand] || ignore;\n\ncommand();"],"names":["Command","CommandDescription","Project","ProjectDescription","ProjectExample","Result","Prefix","StringConstant","ProjectOptions","ProjectOptionsDescription","HiddenProjectOptions","Interface","PhpLaravelPath","CommandlineHelpTitle","ignore","params","ignored","errorMessage","noProjectTypeOptionSpecified","type","vamtigerProject","project","phpLaravel","noProjectNameOptionSpecified","projectFolder","resolvePath","__dirname","npmApiInstallOptional","save-optional","no-audit","prefix","npm-install-save-optional.sh","php-laravel-create-project.sh","php-laravel-install-dev-dependencies.sh","php-laravel-install-dependencies.sh","php-laravel-is-composer-installed.sh","cliInstallOptional","cliOptional","apiInstall","async","projects","currentProjects","join","command","bashScript","trim","bash","toString","Promise","resolve","reject","npm.load","error","loadData","npm.commands","install","installData","name","destination","process","cwd","cli","path","source","require","folderContent","getFolderContent","currentDestination","composerIsInstalled","then","output","Boolean","copyParams","includes","createFolder","createProjectWithComposer","copy","sourceTestsFeaturesFolder","testsFeauture","sourceBehatYml","behatYml","destinationBehatYml","destinationTestFeaturesFolder","bashOptions","creatProject","all","catch","installDevDependencies","removeTests","remove","folder","copyTests","copyBehatYml","copyFile","createProject","[object Object]","cliMessage","vamtiger","createdProject","newline","createCurrentProject","dash","installParams","console","log","args","Args","get","raw","length","projectParams","Error","getHelp","help","projectHelp","3","commandArg","getHelpText","helpText","commandLineHelp","description","option","options","projectType","example","2","currentCommand","commands"],"mappings":"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"}